# Session 3: Template Field Glossaries

**Branch**: `v0.0.7-alpha-p1-s3`
**Phase**: 1 (Critical UX Fixes)
**Session**: 3 of 9
**Model**: Sonnet 4.5
**Estimated Time**: 1-1.5 hours
**Estimated Tokens**: ~25K
**Parallelizable**: ✅ Yes (with Session 2, after Session 1 completes)
**Status**: ⬜ Not Started

---

## Prerequisites

### Previous Sessions
- [ ] Session 1 (v0.0.7-alpha-p1-s1) completed and merged
- [ ] Session 2 (v0.0.7-alpha-p1-s2) completed and merged
- [ ] Both sessions pushed to remote

### Git State
- [ ] Currently on branch: `v0.0.7-alpha-gitbook-docs`
- [ ] Working directory is clean
- [ ] Latest changes pulled: `git pull origin v0.0.7-alpha-gitbook-docs`

### Verification Commands
```bash
git checkout v0.0.7-alpha-gitbook-docs
git pull origin v0.0.7-alpha-gitbook-docs
git status  # Should show clean working tree
git log --oneline -5  # Should see Sessions 1 and 2 commits
```

---

## Session Goals

**Primary Objective**: Add inline field explanations to templates so users know which fields to fill

**What We're Fixing**:
- Templates have 15 YAML frontmatter fields with no explanation
- Users don't know which fields are auto-filled by commands vs manually filled
- ISO 8601 dates, git metadata, "sources" format all assumed knowledge
- Pain point: User stares at YAML, doesn't know what to fill

**Impact**: Reduces template confusion for non-Claude users doing manual workflows

---

## Files to Modify

### Primary Files (Modify)
1. **core/templates/lessons-learned/lesson-template.md**
   - Add [AUTO] and [MANUAL] markers
   - Inline comments explaining each field
   - Example values in comments

2. **core/templates/decisions/ADR-template.md**
   - Add [AUTO] and [MANUAL] markers
   - Inline comments explaining each field
   - Example values in comments

3. **core/templates/knowledge/entry-template.md**
   - Add [AUTO] and [MANUAL] markers
   - Inline comments explaining each field

4. **core/templates/sessions/session-template.md**
   - Add [AUTO] and [MANUAL] markers
   - Inline comments explaining each field

### Files to Read First
- All template files in `core/templates/`
- `/commands/capture-lesson.md` (to understand which fields are auto-filled)
- `/core/docs/WORKFLOWS.md` (to understand manual workflow)

---

## Implementation Steps

### Step 1: Create Branch
```bash
git checkout -b v0.0.7-alpha-p1-s3
```

### Step 2: Analyze Auto vs Manual Fields

**Auto-filled fields** (by `/knowledge:capture-lesson` command):
- `created` - Auto-generated timestamp
- `author` - From git config
- `email` - From git config
- `git.branch` - Current git branch
- `git.commit` - Latest commit hash
- `git.pr` - Detected from branch name or null
- `git.issue` - Detected from branch name or null

**Manual fields** (user must fill):
- `title` - Lesson title
- `tags` - Custom tags
- `category` - architecture/process/patterns/debugging
- `sources` - External references (optional)

**Hybrid fields** (command suggests, user can override):
- `category` - Command suggests based on content

### Step 3: Add Field Glossary to lesson-template.md

**Before** (current state):
```yaml
---
title: "Lesson: [Title]"
created: YYYY-MM-DDTHH:MM:SSZ
author: [Your Name]
email: [Your Email]
git:
  branch: [branch-name]
  commit: [commit-hash]
  pr: [pr-number or null]
  issue: [issue-number or null]
sources:
  - url: "https://example.com/article"
    title: "Article Title"
    accessed: "YYYY-MM-DD"
    context: "Used for [specific insight]"
tags: []
category: [architecture|process|patterns|debugging]
---
```

**After** (with glossary):
```yaml
---
# ====================
# YAML FRONTMATTER - Metadata for this lesson
# Fields marked [AUTO] are filled by /knowledge:capture-lesson command
# Fields marked [MANUAL] require you to fill them in
# ====================

title: "Lesson: [Title]"  # [MANUAL] Short descriptive title (e.g., "Lesson: Database Connection Pooling")

created: YYYY-MM-DDTHH:MM:SSZ  # [AUTO] Timestamp when lesson was created (ISO 8601 format: 2024-01-15T14:30:00Z)

author: [Your Name]  # [AUTO] Filled from git config user.name

email: [Your Email]  # [AUTO] Filled from git config user.email

git:  # [AUTO] All git metadata detected automatically
  branch: [branch-name]  # Current git branch (e.g., feature/add-pooling)
  commit: [commit-hash]  # Latest commit SHA (e.g., a1b2c3d)
  pr: [pr-number or null]  # PR number if branch named like "feature/123-title", otherwise null
  issue: [issue-number or null]  # Issue number if branch named like "issue/456-bug", otherwise null

sources:  # [MANUAL] External articles/docs consulted (optional, delete if not used)
  - url: "https://example.com/article"  # Full URL to source
    title: "Article Title"  # Title of article/documentation
    accessed: "YYYY-MM-DD"  # Date you accessed it (format: 2024-01-15)
    context: "Used for [specific insight]"  # Why you referenced this source

tags: []  # [MANUAL] Custom tags for searching (e.g., [database, performance, postgresql])

category: [architecture|process|patterns|debugging]  # [AUTO-SUGGEST] Command suggests, you can override
# - architecture: System design, component structure
# - process: Workflow improvements, tools, procedures
# - patterns: Reusable design patterns, best practices
# - debugging: Troubleshooting, bug fixes, investigations
---
```

### Step 4: Update Other Templates Similarly
- [ ] Apply same pattern to `ADR-template.md`
- [ ] Apply same pattern to `entry-template.md`
- [ ] Apply same pattern to `session-template.md`
- [ ] Apply same pattern to `meta-issue/description.md` template

### Step 5: Update Template README Files
- [ ] Add "Field Guide" section to `core/templates/lessons-learned/README.md`
- [ ] Add "Field Guide" section to `core/templates/decisions/README.md`
- [ ] Link to examples showing filled-out templates
- [ ] Add troubleshooting: "If you see [MANUAL], fill it. If you see [AUTO], command fills it."

---

## Acceptance Criteria

### Template Quality
- [ ] All YAML fields have inline comments
- [ ] [AUTO] and [MANUAL] markers clearly distinguish workflow
- [ ] Example values provided for complex fields (ISO 8601, sources array)
- [ ] Comments explain WHY field exists, not just WHAT it is
- [ ] Category options explained with examples

### Consistency
- [ ] All templates use same marker format: `# [AUTO]` and `# [MANUAL]`
- [ ] Terminology consistent across templates (e.g., "ISO 8601" explained once)
- [ ] Example formats match actual command output

### User Experience
- [ ] Non-technical user can read template and know what to fill
- [ ] Manual workflow users (non-Claude) have clear guidance
- [ ] Claude Code users can see what command auto-fills
- [ ] No jargon without inline explanation

### Documentation
- [ ] Template README files updated with field guides
- [ ] Links to examples added (pointing to core/examples/)
- [ ] Troubleshooting section added to README files

---

## Definition of Done

### Code Changes
- [ ] `core/templates/lessons-learned/lesson-template.md` updated
- [ ] `core/templates/decisions/ADR-template.md` updated
- [ ] `core/templates/knowledge/entry-template.md` updated
- [ ] `core/templates/sessions/session-template.md` updated
- [ ] `core/templates/lessons-learned/README.md` updated
- [ ] `core/templates/decisions/README.md` updated

### Quality Checks
- [ ] All templates tested: Copy template, fill MANUAL fields, save
- [ ] YAML parses correctly (no syntax errors from comments)
- [ ] **Plugin command verification**: Run `/knowledge:capture-lesson` after template modification to confirm the command still parses templates correctly with the added comments
- [ ] **MCP tool verification**: Test that `kg_scaffold` MCP tool still generates valid output from the modified templates
- [ ] User reviews template and confirms clarity
- [ ] Link checker for template READMEs

### Git Workflow
- [ ] All changes committed with clear message
- [ ] Branch pushed: `git push -u origin v0.0.7-alpha-p1-s3`
- [ ] No merge conflicts with base

### User Validation
- [ ] User confirms field explanations are accurate
- [ ] User tests: "Open lesson-template.md and fill it out" (<5 min)
- [ ] User approves [AUTO] vs [MANUAL] classifications

---

## Verification Commands

### Before Starting
```bash
# Ensure Sessions 1-2 merged
git checkout v0.0.7-alpha-gitbook-docs
git pull origin v0.0.7-alpha-gitbook-docs
git log --oneline -5  # Should see Sessions 1-2

# Create branch
git checkout -b v0.0.7-alpha-p1-s3
```

### During Work
```bash
# Test YAML parsing (ensure comments don't break syntax)
python3 -c "import yaml; yaml.safe_load(open('core/templates/lessons-learned/lesson-template.md').read().split('---')[1])"

# Count [AUTO] markers
grep -r "\[AUTO\]" core/templates/ | wc -l  # Should be ~30-40

# Count [MANUAL] markers
grep -r "\[MANUAL\]" core/templates/ | wc -l  # Should be ~15-20
```

### Before Committing
```bash
# Review changes
git diff core/templates/

# Stage template files
git add core/templates/lessons-learned/lesson-template.md
git add core/templates/decisions/ADR-template.md
git add core/templates/knowledge/entry-template.md
git add core/templates/sessions/session-template.md
git add core/templates/lessons-learned/README.md
git add core/templates/decisions/README.md

# Commit
git commit -m "docs: add [AUTO]/[MANUAL] field glossaries to templates

- Added inline comments explaining each YAML frontmatter field
- Marked fields as [AUTO] (command-filled) or [MANUAL] (user-filled)
- Provided example values for complex fields (ISO 8601, sources)
- Updated template README files with field guides
- Resolves template confusion for manual workflow users

Co-Authored-By: Claude Sonnet 4.5 <noreply@anthropic.com>"

# Push
git push -u origin v0.0.7-alpha-p1-s3
```

### After Completion
```bash
# Verify push succeeded
git log --oneline -1  # Should see Session 3 commit

# Branch remains open for review - DO NOT MERGE YET
# Merging will be done manually after review
```

---

## Next Session

**After this session completes**:
- [ ] Branch pushed to origin: v0.0.7-alpha-p1-s3
- [ ] Branch ready for review (do not merge yet)
- [ ] **CHECKPOINT**: Review Sessions 1-3 with user before proceeding
- [ ] Proceed to Session 4: Create CONCEPTS.md (Opus 4.6)
- [ ] Branch name: `v0.0.7-alpha-p1-s4`

---

## Notes

**Critical Constraint**: DO NOT change field names or structure
- Commands depend on exact field names (`git.branch`, `created`, etc.)
- Only add comments, don't modify schema
- Test YAML parsing after changes
- **IMPORTANT**: After modifying templates, verify that `/knowledge:capture-lesson` and `kg_scaffold` MCP tool still work correctly with the commented templates. YAML comments are valid syntax, but the plugin's commands parse these templates — confirm no breakage.

**Template Preservation**:
- Templates serve dual purpose: Claude automation + manual workflows
- Comments help manual users without breaking automation
- Commands ignore comments when parsing

**User Testing**:
- After this session, ask non-technical user: "Fill out lesson-template.md"
- Success: They fill only [MANUAL] fields, skip [AUTO] fields
- Time: Should take <5 minutes

**Time Estimate Breakdown**:
- Analyze auto vs manual fields: 10-15 min
- Update lesson-template.md: 15-20 min
- Update other templates: 20-25 min
- Update README files: 15-20 min
- Quality checks + YAML validation: 10 min
- **Total**: 60-90 minutes (1-1.5 hours)

---

**Status**: ⬜ Not Started
**Last Updated**: 2026-02-20 (Opus review revision — added plugin verification step, parallelization note)
